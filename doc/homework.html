<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="By 20022" />

<meta name="date" content="2020-12-19" />

<title>Homework 20022</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework 20022</h1>
<h4 class="author">By 20022</h4>
<h4 class="date">2020-12-19</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one ﬁgure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>##The 1st example:</p>
<p>Two sets of data are given below,the corresponding scatter plots are made in the figure,and the regression line is drawn.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>X&lt;-<span class="kw">c</span>(<span class="fl">22.44</span>,<span class="fl">14.48</span>,<span class="fl">20.73</span>,<span class="fl">19.25</span>,<span class="fl">20.37</span>,<span class="fl">26.43</span>,<span class="fl">12.14</span>,<span class="fl">23.31</span>,<span class="fl">16.23</span>,<span class="fl">0.56</span>,<span class="fl">0.84</span>,<span class="fl">18.05</span>,<span class="fl">12.45</span>,<span class="fl">11.33</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>Y&lt;-<span class="kw">c</span>(<span class="fl">2.40</span>,<span class="fl">2.98</span>,<span class="fl">2.06</span>,<span class="fl">1.09</span>,<span class="fl">1.96</span>,<span class="fl">1.55</span>,<span class="fl">2.16</span>,<span class="fl">1.60</span>,<span class="fl">0.80</span>,<span class="fl">1.94</span>,<span class="fl">3.00</span>,<span class="fl">0.28</span>,<span class="fl">0.84</span>,<span class="fl">1.80</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>data&lt;-<span class="kw">data.frame</span>(X,Y)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">plot</span>(X,Y,<span class="dt">pch=</span><span class="dv">23</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">bg=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>LM&lt;-<span class="kw">lm</span>(Y<span class="op">~</span>X,data)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">abline</span>(LM)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>##The 3rd example：</p>
<p><span class="math display">\[\begin{align*}
\boldsymbol{y}=&amp;\boldsymbol{X}\boldsymbol{\beta}+\boldsymbol{\epsilon}\\
\frac{1}{2}\left\Vert\boldsymbol{y}-\boldsymbol{X}\boldsymbol{\beta}\right\Vert_2^2+\lambda\sum_{j=1}^d p_j(|\beta_j|)=&amp;\frac{1}{2}\left\Vert\boldsymbol{y}-\hat{\boldsymbol{y}}\right\Vert_2^2+\frac{1}{2}\sum_{j=1}^d (z_j-\beta_j)^2+\lambda\sum_{j=1}^d p_j(|\beta_j|)
\end{align*}\]</span></p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.9, 3.10, and 3.13 (pages 94-95, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.3</h3>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^a,x\geq b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="solution" class="section level3">
<h3>Solution:</h3>
<p>The probability density function is <span class="math inline">\(f(x)=F&#39;(x)=ab^ax^{-(a+1)}\)</span>. Let <span class="math inline">\(y=1-(\frac{b}{x})^a\)</span>,and then we have <span class="math inline">\(x=b(1-y)^{-\frac{1}{a}}\)</span>,so <span class="math display">\[F^{-1}(U)=b(1-U)^{-\frac{1}{a}}\]</span> The relevant code and the histogram density estimate and the true density function are given below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>generate.pareto&lt;-<span class="cf">function</span>(n,a,b){</span>
<span id="cb2-2"><a href="#cb2-2"></a>  u=<span class="kw">runif</span>(n)</span>
<span id="cb2-3"><a href="#cb2-3"></a>  P=b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>a)</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="kw">return</span> (P)</span>
<span id="cb2-5"><a href="#cb2-5"></a>}</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>a=<span class="dv">2</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>b=<span class="dv">2</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>x=<span class="kw">generate.pareto</span>(<span class="fl">1e4</span>,a,b)</span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">main=</span><span class="st">&quot;Histogram of Pareto(2,2)&quot;</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a>y=<span class="kw">sort</span>(x)</span>
<span id="cb2-14"><a href="#cb2-14"></a>fy=a<span class="op">*</span>b<span class="op">^</span>a<span class="op">*</span>y<span class="op">^</span>(<span class="op">-</span>(a<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="kw">lines</span>(y,fy,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.9</h3>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),\quad |x|\leq 1.\]</span> Devroye and Gyorﬁ [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3 \sim Uniform(-1,1).\)</span> If <span class="math inline">\(|U_3|&gt;|U_2|\)</span> and <span class="math inline">\(|U_3|&gt;|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="solution-1" class="section level3">
<h3>Solution:</h3>
<p>The relevant code and the histogram density estimate and the kernel density function are given below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>generate.fe&lt;-<span class="cf">function</span>(n){</span>
<span id="cb3-2"><a href="#cb3-2"></a>  U1=<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>  U2=<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>  U3=<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>  U=<span class="kw">ifelse</span>((<span class="kw">abs</span>(U3)<span class="op">&gt;=</span><span class="kw">abs</span>(U2) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(U3)<span class="op">&gt;=</span><span class="kw">abs</span>(U1)),U2,U3)</span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="kw">return</span>(U)</span>
<span id="cb3-7"><a href="#cb3-7"></a>}</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>U=<span class="kw">generate.fe</span>(<span class="fl">1e4</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="kw">hist</span>(U,<span class="dt">breaks=</span><span class="dv">20</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Histogram of &quot;</span>, f[e])))</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw">lines</span>(<span class="kw">density</span>(U),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level3">
<h3>3.10</h3>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="solution-2" class="section level3">
<h3>Solution:</h3>
<p>From <span class="math inline">\(U_1,U_2,U_3 \sim Uniform(-1,1)\)</span>,we have <span class="math inline">\(|U|\sim Uniform(0,1)\)</span>. Let <span class="math inline">\(V_i=|U_i|,i=1,2,3\)</span>. If <span class="math inline">\(V_3=max(V_1,V_2,V_3)\)</span>,then <span class="math inline">\(V=V_2\)</span>,otherwise <span class="math inline">\(V=V_3\)</span>. But because <span class="math inline">\(V_i=|U_i|,i=1,2,3\)</span>,so we can deliver <span class="math inline">\(Y=\pm V\)</span> with probability 1/2,1/2 finally. And then we have <span class="math display">\[G_i(y_i)=P(V_i\leq y_i)=\sum_{j=i}^3C_3^j[F(y_i)]^j[1-F(y_i)^{3-j}],\]</span> where <span class="math inline">\(F(y_i)=y_i\)</span> is the cdf of <span class="math inline">\(Uniform(0,1)\)</span>. Now we have the distribution function of V: <span class="math display">\[\begin{align*}
G(v)&amp;=\frac{1}{2}G_1(v)+\frac{1}{2}G_2(v)\\
&amp;=\frac{1}{2}(3v-v^3)
\end{align*}\]</span> <span class="math display">\[g(v)=G&#39;(v)=\frac{3}{2}(1-v^2)\]</span> then the density of Y is <span class="math inline">\(f_Y(y)=\frac{1}{2}\times\frac{3}{2}(1-v^2)=\frac{3}{4}(1-v^2),y\in (-1,1)\)</span>.</p>
</div>
<div id="section-3" class="section level3">
<h3>3.13</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^r,y\geq0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical(Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="solution-3" class="section level3">
<h3>Solution:</h3>
<p>The probability density function is <span class="math inline">\(f(y)=F&#39;(y)=r\beta^r(\beta+y)^{-(r+1)}\)</span>. We have <span class="math inline">\(F^{-1}(y)=\beta\{\frac{1}{(1-y)^{1/r}}-1\}\)</span>. The relevant code and the histogram density estimate and the superimposing density function are given below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>generate.alt.pareto&lt;-<span class="cf">function</span>(n,beta,r){</span>
<span id="cb4-2"><a href="#cb4-2"></a>  U=<span class="kw">runif</span>(n)</span>
<span id="cb4-3"><a href="#cb4-3"></a>  P=beta<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>U)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r))<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="kw">return</span>(P)</span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>beta=<span class="dv">2</span>;r=<span class="dv">4</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>x=<span class="kw">generate.alt.pareto</span>(<span class="fl">1e4</span>,beta,r)</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Histogram of Pareto(2,4)&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a>y=<span class="kw">sort</span>(x)</span>
<span id="cb4-12"><a href="#cb4-12"></a>fy=r<span class="op">*</span>beta<span class="op">^</span>r<span class="op">*</span>(beta<span class="op">+</span>y)<span class="op">^</span>(<span class="op">-</span>(r<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="kw">lines</span>(y,fy,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.7, and 5.11 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-4" class="section level3">
<h3>5.1</h3>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\pi/3}\sin t\ dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="solution-4" class="section level3">
<h3>Solution:</h3>
<p>##Answer Firstly, according to calculus, we have <span class="math display">\[\int_{0}^{\frac{\pi}{3}}sint dt = \frac{1}{2}\]</span> Since <span class="math inline">\(sinx = x - \frac{x^3}{6} + O(x^5)\)</span> So firstly, I use <span class="math inline">\(x - \frac{x^3}{6}\)</span> as the control variate and <span class="math display">\[E[x - \frac{x^3}{6}] = \int_{0}^{\frac{\pi}{3}}(x - \frac{x^3}{6})dx / \frac{\pi}{3} = \frac{\pi}{6} - \frac{\pi^3}{648}\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb5-2"><a href="#cb5-2"></a>UP =<span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>U =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>, <span class="dv">0</span>, UP)</span>
<span id="cb5-4"><a href="#cb5-4"></a>G =<span class="st"> </span><span class="kw">sin</span>(U)</span>
<span id="cb5-5"><a href="#cb5-5"></a>CONTROL =<span class="st"> </span>U <span class="op">-</span><span class="st"> </span>U<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="dv">6</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>ECONTROL =<span class="st"> </span>pi<span class="op">/</span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span>pi<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="dv">648</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>L =<span class="st"> </span><span class="kw">lm</span>(G <span class="op">~</span><span class="st"> </span>CONTROL)</span>
<span id="cb5-8"><a href="#cb5-8"></a>cstar =<span class="st"> </span>L<span class="op">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb5-9"><a href="#cb5-9"></a>G_adjust =<span class="st"> </span>G <span class="op">-</span><span class="st"> </span>cstar<span class="op">*</span>(CONTROL <span class="op">-</span><span class="st"> </span>ECONTROL)</span>
<span id="cb5-10"><a href="#cb5-10"></a>result_adj =<span class="st"> </span><span class="kw">mean</span>(G_adjust)<span class="op">*</span>UP</span>
<span id="cb5-11"><a href="#cb5-11"></a>result_<span class="dv">0</span> =<span class="st"> </span><span class="kw">mean</span>(G)<span class="op">*</span>UP</span>
<span id="cb5-12"><a href="#cb5-12"></a>var_<span class="dv">0</span> =<span class="st"> </span><span class="kw">var</span>(G)<span class="op">*</span>UP<span class="op">^</span><span class="dv">2</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>var_adjust =<span class="st"> </span><span class="kw">var</span>(G_adjust)<span class="op">*</span>UP<span class="op">^</span><span class="dv">2</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>percentage_empirical =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>var_adjust<span class="op">/</span>var_<span class="dv">0</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>percentage_theorical =<span class="st"> </span><span class="kw">summary</span>(L)<span class="op">$</span>r.squared</span>
<span id="cb5-16"><a href="#cb5-16"></a>result =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(result_<span class="dv">0</span>,result_adj))</span>
<span id="cb5-17"><a href="#cb5-17"></a>result =<span class="st"> </span><span class="kw">cbind</span>(result,<span class="kw">c</span>(<span class="kw">sqrt</span>(var_<span class="dv">0</span>),<span class="kw">sqrt</span>(var_adjust)))</span>
<span id="cb5-18"><a href="#cb5-18"></a>result =<span class="st"> </span><span class="kw">cbind</span>(result, <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;unadjust&#39;</span>,<span class="st">&#39;adjust&#39;</span>)</span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;estimate&#39;</span>,<span class="st">&#39;standard error&#39;</span>, <span class="st">&#39;True&#39;</span>)</span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="kw">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">estimate</th>
<th align="right">standard error</th>
<th align="right">True</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">unadjust</td>
<td align="right">0.4993229</td>
<td align="right">0.2669007</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">adjust</td>
<td align="right">0.4999861</td>
<td align="right">0.0017135</td>
<td align="right">0.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="dv">100</span><span class="op">*</span><span class="kw">c</span>(percentage_empirical,percentage_theorical) -&gt;tb</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">names</span>(tb) &lt;-<span class="kw">c</span>(<span class="st">&#39;empirical&#39;</span>, <span class="st">&#39;theorical&#39;</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>tb =<span class="st"> </span><span class="kw">as.matrix</span>(tb)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">colnames</span>(tb) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;percentage of variance reduced(control variate)&#39;</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">kable</span>(tb)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">percentage of variance reduced(control variate)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">empirical</td>
<td align="right">99.99588</td>
</tr>
<tr class="even">
<td align="left">theorical</td>
<td align="right">99.99588</td>
</tr>
</tbody>
</table>
</div>
<div id="section-5" class="section level3">
<h3>5.7</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="solution-5" class="section level3">
<h3>Solution:</h3>
<p>I generate X ~ U(0,1), and Y = 1-X, so X and Y are negatively correlated.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>X =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>Y =<span class="st"> </span><span class="dv">1</span><span class="op">-</span>X</span>
<span id="cb7-3"><a href="#cb7-3"></a>G1 =<span class="st"> </span><span class="kw">exp</span>(X)</span>
<span id="cb7-4"><a href="#cb7-4"></a>G2 =<span class="st"> </span><span class="kw">exp</span>(Y)</span>
<span id="cb7-5"><a href="#cb7-5"></a>G =<span class="st"> </span>(G1<span class="op">+</span>G2)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>X2 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>G3 =<span class="st"> </span><span class="kw">exp</span>(X2)</span>
<span id="cb7-8"><a href="#cb7-8"></a>result_original =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(G1,G3)), <span class="kw">sd</span>(<span class="kw">c</span>(G1,G3)))</span>
<span id="cb7-9"><a href="#cb7-9"></a>result_anti =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(G), <span class="kw">sd</span>(G))    </span>
<span id="cb7-10"><a href="#cb7-10"></a>result =<span class="kw">matrix</span>(<span class="kw">c</span>(result_anti,result_original),<span class="dv">2</span>,<span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;estimate&#39;</span>, <span class="st">&#39;standard error&#39;</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;anti&#39;</span>, <span class="st">&#39;normal&#39;</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a>percentage_reduced =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(G)<span class="op">/</span><span class="kw">var</span>(<span class="kw">c</span>(G1,G3))</span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="kw">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">estimate</th>
<th align="right">standard error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">anti</td>
<td align="right">1.718108</td>
<td align="right">0.0624305</td>
</tr>
<tr class="even">
<td align="left">normal</td>
<td align="right">1.714951</td>
<td align="right">0.4915698</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">print</span>(percentage_reduced)</span></code></pre></div>
<pre><code>## [1] 0.9838704</code></pre>
</div>
<div id="section-6" class="section level3">
<h3>5.11</h3>
<p>If <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta_c}=c\hat{\theta_1}+(1-c)\hat{\theta_2}\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, ﬁnd the value c∗ that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta_c}=c\hat{\theta_1}+(1-c)\hat{\theta_2}\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="solution-6" class="section level3">
<h3>Solution:</h3>
<p>The variance of <span class="math inline">\(c\hat{\theta_1}+(1-c)\hat{\theta_2}\)</span> is <span class="math display">\[Var(\hat{\theta_2})+c^2Var(\hat{\theta_1}-\hat{\theta_2})+2cCov(\hat{\theta_2},\hat{\theta_1}-\hat{\theta_2})\]</span> and when <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are antithetic we can derive that <span class="math display">\[Cor(\hat{\theta_1},\hat{\theta_2})=-1,\ then\quad Cov(\hat{\theta_1},\hat{\theta_2})=-Var(\hat{\theta_1})\]</span> So the variance of <span class="math inline">\(\hat{\theta_c}\)</span> is <span class="math display">\[Var\hat{\theta_c}=4c^2Var(\hat{\theta_1})-4cVar(\hat{\theta_1})+Var(\hat{\theta_1})=(4c^2-4c+1)Var(\hat{\theta_1})\]</span> and the optimal condition is <span class="math inline">\(8c-4=0,\ \text{i.e.} \quad c^*=1/2\)</span>.</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 5.13, 5.15, 6.4, and 6.5 (page 151 and 180, Statistical Computating with R).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-7" class="section level3">
<h3>5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty )\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="solution-7" class="section level3">
<h3>Solution:</h3>
<p>The candidates for the importance functions are <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2},\ -\infty&lt;x&lt;\infty,\]</span> <span class="math display">\[f_2(x)=\frac{1}{x^2},\ 1&lt;x&lt;\infty.\]</span> The integrand is <span class="math display">\[g(x)=\begin{cases}
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},&amp; 1&lt;x&lt;\infty\\
0,&amp; otherwise.\end{cases}\]</span></p>
<p>The <span class="math inline">\(f_2\)</span> will produce the smaller variance in estimating,because <span class="math inline">\(f_1\)</span> has larger ranges and many of the simulated values will contribute zeros to the sum, which is inefficient.</p>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>theta.hat&lt;-se&lt;-<span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>g&lt;-<span class="cf">function</span>(x){</span>
<span id="cb10-4"><a href="#cb10-4"></a>  x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>}</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#f1</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>x&lt;-<span class="kw">rnorm</span>(m)</span>
<span id="cb10-9"><a href="#cb10-9"></a>fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">dnorm</span>(x)</span>
<span id="cb10-10"><a href="#cb10-10"></a>theta.hat[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb10-11"><a href="#cb10-11"></a>se[<span class="dv">1</span>]&lt;-<span class="kw">sd</span>(fg)</span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#f2</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>u&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb10-15"><a href="#cb10-15"></a>x&lt;-<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)</span>
<span id="cb10-16"><a href="#cb10-16"></a>fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span>x<span class="op">^</span><span class="dv">2</span></span>
<span id="cb10-17"><a href="#cb10-17"></a>theta.hat[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb10-18"><a href="#cb10-18"></a>se[<span class="dv">2</span>]&lt;-<span class="kw">sd</span>(fg)</span>
<span id="cb10-19"><a href="#cb10-19"></a></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="kw">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]       [,2]
## theta.hat 0.4263302 0.08300236
## se        1.1976695 0.08484203</code></pre>
<p>From the graphs,we might prefer <span class="math inline">\(f_2\)</span> for smaller variance.</p>
</div>
<div id="section-8" class="section level3">
<h3>5.15</h3>
<p>Obtain the stratiﬁed importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="solution-8" class="section level3">
<h3>Solution:</h3>
<p>First,we derive the stratiﬁed importance sampling estimate in Example 5.13:</p>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>theta.hat&lt;-se&lt;-<span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>g&lt;-<span class="cf">function</span>(x){</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="kw">exp</span>(<span class="op">-</span>x<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb12-5"><a href="#cb12-5"></a>}</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb12-8"><a href="#cb12-8"></a>  u&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb12-9"><a href="#cb12-9"></a>  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span><span class="dv">5</span>))<span class="op">*</span>u)</span>
<span id="cb12-10"><a href="#cb12-10"></a>  fg&lt;-<span class="kw">g</span>(x)<span class="op">*</span>(x<span class="op">&gt;</span>((i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>))<span class="op">*</span>(x<span class="op">&lt;</span>(i<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb12-11"><a href="#cb12-11"></a>  theta.hat[i]&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb12-12"><a href="#cb12-12"></a>  se[i]&lt;-<span class="kw">sd</span>(fg)</span>
<span id="cb12-13"><a href="#cb12-13"></a>}</span>
<span id="cb12-14"><a href="#cb12-14"></a>theta&lt;-<span class="kw">sum</span>(theta.hat)</span>
<span id="cb12-15"><a href="#cb12-15"></a>se&lt;-<span class="kw">sum</span>(se)<span class="op">/</span><span class="dv">5</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="kw">rbind</span>(theta,se)</span></code></pre></div>
<pre><code>##              [,1]
## theta 0.524896785
## se    0.003362649</code></pre>
<p>The standard error of the stratified importance methods is 0.003390232, which is much smaller than the 0.9661300 of example 5.10.</p>
<p>From the results above, we can conclude that the variance is reduced by stratification.</p>
</div>
<div id="section-9" class="section level3">
<h3>6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% conﬁdence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the conﬁdence level.</p>
</div>
<div id="solution-9" class="section level3">
<h3>Solution:</h3>
<p>First we construct a 95% conﬁdence interval for the parameter <span class="math inline">\(\mu\)</span>.</p>
<p>The calculation of the 95% upper conﬁdence limit (UCL) for a random sample size n = 20 from a Normal(0,<span class="math inline">\(\sigma^2 = 4\)</span>) distribution is shown below.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>calcCI &lt;-<span class="st"> </span><span class="cf">function</span>(n, alpha) {</span>
<span id="cb14-2"><a href="#cb14-2"></a>  u &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>  y&lt;-<span class="kw">exp</span>(u)</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(y)<span class="op">-</span><span class="kw">sd</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb14-5"><a href="#cb14-5"></a>}</span>
<span id="cb14-6"><a href="#cb14-6"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> <span class="kw">calcCI</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">alpha =</span> <span class="fl">.05</span>)) </span></code></pre></div>
<p>Thne we use a Monte Carlo method to obtain an empirical estimate of the conﬁdence level.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb15-4"><a href="#cb15-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>  y&lt;-<span class="kw">exp</span>(x)</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="kw">mean</span>(y)<span class="op">-</span><span class="kw">sd</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb15-7"><a href="#cb15-7"></a>})</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#count the number of intervals that contain mu=0</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="kw">sum</span>(<span class="kw">log</span>(UCL)<span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 956</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#or compute the mean to get the confidence level</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">mean</span>(<span class="kw">log</span>(UCL) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) </span></code></pre></div>
<pre><code>## [1] 0.956</code></pre>
</div>
<div id="section-10" class="section level3">
<h3>6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the conﬁdence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="solution-10" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">1020</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>generate &lt;-<span class="st"> </span><span class="cf">function</span>(n, alpha){</span>
<span id="cb19-3"><a href="#cb19-3"></a>  X &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>  B &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">sqrt</span>(<span class="kw">var</span>(X)<span class="op">/</span>n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>))</span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(X)<span class="op">-</span>B,<span class="kw">mean</span>(X)<span class="op">+</span>B))</span>
<span id="cb19-6"><a href="#cb19-6"></a>}</span>
<span id="cb19-7"><a href="#cb19-7"></a>RESULT &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> <span class="kw">generate</span>(<span class="dv">20</span>,<span class="fl">0.05</span>))</span>
<span id="cb19-8"><a href="#cb19-8"></a>REALmean &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>temp1 &lt;-<span class="st"> </span>RESULT[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">2</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>temp2 &lt;-<span class="st"> </span>RESULT[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">2</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>Proportion &lt;-<span class="st"> </span><span class="kw">sum</span>(temp1<span class="op">&amp;</span>temp2)<span class="op">/</span><span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co"># the proportion that confidence interval contains the real mean</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>Proportion</span></code></pre></div>
<pre><code>## [1] 90.7</code></pre>
<p>So the proportion that estimates are contained by the CI is about <span class="math inline">\(91.7 \%\)</span></p>
<p>Comparing with example 6.4 and 6.6, the confidence interval of <span class="math inline">\(\overline{X}\)</span> is more robust than the confidence interval of <span class="math inline">\(\sigma^2\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2"></a>data_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="kw">t</span>(RESULT),<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>))</span>
<span id="cb21-3"><a href="#cb21-3"></a>data_<span class="dv">0</span><span class="op">$</span>fac =<span class="st"> </span><span class="kw">as.factor</span>(temp1<span class="op">&amp;</span>temp2)</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">ggplot</span>(data_<span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">x=</span>V3, <span class="dt">ymin=</span>V1,<span class="dt">ymax =</span> V2,<span class="dt">color=</span>fac),<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.7, 6.8, and 6.C (pages 180-182, Statistical Computating with R).</p>
<p>Discussion：If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say,0.651 for one method and 0.676 for another method. Can we say the powers are diﬀerent at 0.05 level? (1) What is the corresponding hypothesis test problem? (2) What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? (3) What information is needed to test your hypothesis?</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-11" class="section level3">
<h3>6.7</h3>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha,\alpha\)</span>) distributions and comment on the results. Are the results diﬀerent for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="solution-11" class="section level3">
<h3>Solution:</h3>
<div id="small-sample" class="section level4">
<h4>Small sample</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>alpha &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>p.reject &lt;-<span class="st"> </span>p.heavy &lt;-<span class="st"> </span>cv &lt;-<span class="st"> </span>xbar &lt;-ybar &lt;-<span class="st"> </span>m31 &lt;-<span class="st"> </span>m32 &lt;-<span class="st"> </span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="st">  </span>m21 &lt;-<span class="st"> </span>m22 &lt;-<span class="st"> </span>u &lt;-<span class="st"> </span>v &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#to store sim. results </span></span>
<span id="cb22-6"><a href="#cb22-6"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>sktests &lt;-<span class="st"> </span>heavy &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb22-11"><a href="#cb22-11"></a>    cv[i] &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n[i]<span class="op">-</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n[i]<span class="op">+</span><span class="dv">3</span>))))  </span>
<span id="cb22-12"><a href="#cb22-12"></a>    <span class="co">#crit. values for each n</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n[i],alpha,alpha)</span>
<span id="cb22-14"><a href="#cb22-14"></a>    y &lt;-<span class="st"> </span><span class="kw">rt</span>(n[i],<span class="dv">2</span>)</span>
<span id="cb22-15"><a href="#cb22-15"></a>    xbar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb22-16"><a href="#cb22-16"></a>    ybar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb22-17"><a href="#cb22-17"></a>    m31[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar[i])<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb22-18"><a href="#cb22-18"></a>    m32[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y <span class="op">-</span><span class="st"> </span>ybar[i])<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb22-19"><a href="#cb22-19"></a>    m21[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb22-20"><a href="#cb22-20"></a>    m22[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y <span class="op">-</span><span class="st"> </span>ybar[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb22-21"><a href="#cb22-21"></a>    u[i] &lt;-<span class="st"> </span>m31[i] <span class="op">/</span><span class="st"> </span>((m21[i])<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb22-22"><a href="#cb22-22"></a>    v[i] &lt;-<span class="st"> </span>m32[i] <span class="op">/</span><span class="st"> </span>((m22[i])<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb22-23"><a href="#cb22-23"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(u[i])<span class="op">&gt;=</span><span class="st"> </span>cv[i] ) </span>
<span id="cb22-24"><a href="#cb22-24"></a>    heavy[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(v[i])<span class="op">&gt;=</span><span class="st"> </span>cv[i] ) </span>
<span id="cb22-25"><a href="#cb22-25"></a>  }</span>
<span id="cb22-26"><a href="#cb22-26"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected </span></span>
<span id="cb22-27"><a href="#cb22-27"></a>  p.heavy[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(heavy)</span>
<span id="cb22-28"><a href="#cb22-28"></a>}</span>
<span id="cb22-29"><a href="#cb22-29"></a>comparison &lt;-<span class="st"> </span><span class="kw">data.frame</span>(n,p.reject, p.heavy)</span>
<span id="cb22-30"><a href="#cb22-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(comparison)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">n</th>
<th align="right">p.reject</th>
<th align="right">p.heavy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.0507</td>
<td align="right">0.3309</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.0436</td>
<td align="right">0.5021</td>
</tr>
<tr class="odd">
<td align="right">30</td>
<td align="right">0.0389</td>
<td align="right">0.5988</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.0356</td>
<td align="right">0.7130</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">0.0346</td>
<td align="right">0.8128</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.0268</td>
<td align="right">0.9405</td>
</tr>
</tbody>
</table>
<p><em>This is the skewness test of normality in the case of small sample, as can be seen from the table above,the estimated value of power is very accurate when sample is small,and the estimates are getting worse as the sample size increases.</em></p>
</div>
<div id="large-sample" class="section level4">
<h4>Large sample</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>alpha &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="dv">2000</span>) <span class="co">#sample sizes</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>p.reject &lt;-<span class="st"> </span>p.heavy &lt;-<span class="st"> </span>cv &lt;-<span class="st"> </span>xbar &lt;-ybar &lt;-<span class="st"> </span>m31 &lt;-<span class="st"> </span>m32 &lt;-<span class="st"> </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">  </span>m21 &lt;-<span class="st"> </span>m22 &lt;-<span class="st"> </span>u &lt;-<span class="st"> </span>v &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#to store sim. results </span></span>
<span id="cb23-6"><a href="#cb23-6"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>sktests &lt;-<span class="st"> </span>heavy &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb23-11"><a href="#cb23-11"></a>    cv[i] &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n[i]))   </span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="co">#crit. values for each n</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n[i],alpha,alpha)</span>
<span id="cb23-14"><a href="#cb23-14"></a>    y &lt;-<span class="st"> </span><span class="kw">rt</span>(n[i],<span class="dv">2</span>)</span>
<span id="cb23-15"><a href="#cb23-15"></a>    xbar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb23-16"><a href="#cb23-16"></a>    ybar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb23-17"><a href="#cb23-17"></a>    m31[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar[i])<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb23-18"><a href="#cb23-18"></a>    m32[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y <span class="op">-</span><span class="st"> </span>ybar[i])<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb23-19"><a href="#cb23-19"></a>    m21[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb23-20"><a href="#cb23-20"></a>    m22[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y <span class="op">-</span><span class="st"> </span>ybar[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb23-21"><a href="#cb23-21"></a>    u[i] &lt;-<span class="st"> </span>m31[i] <span class="op">/</span><span class="st"> </span>((m21[i])<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb23-22"><a href="#cb23-22"></a>    v[i] &lt;-<span class="st"> </span>m32[i] <span class="op">/</span><span class="st"> </span>((m22[i])<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb23-23"><a href="#cb23-23"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(u[i])<span class="op">&gt;=</span><span class="st"> </span>cv[i] ) </span>
<span id="cb23-24"><a href="#cb23-24"></a>    heavy[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(v[i])<span class="op">&gt;=</span><span class="st"> </span>cv[i] ) </span>
<span id="cb23-25"><a href="#cb23-25"></a>  }</span>
<span id="cb23-26"><a href="#cb23-26"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected </span></span>
<span id="cb23-27"><a href="#cb23-27"></a>  p.heavy[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(heavy)</span>
<span id="cb23-28"><a href="#cb23-28"></a>}</span>
<span id="cb23-29"><a href="#cb23-29"></a>comparison &lt;-<span class="st"> </span><span class="kw">data.frame</span>(n,p.reject, p.heavy)</span>
<span id="cb23-30"><a href="#cb23-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(comparison)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">n</th>
<th align="right">p.reject</th>
<th align="right">p.heavy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1000</td>
<td align="right">0.0287</td>
<td align="right">0.9660</td>
</tr>
<tr class="even">
<td align="right">1500</td>
<td align="right">0.0289</td>
<td align="right">0.9736</td>
</tr>
<tr class="odd">
<td align="right">2000</td>
<td align="right">0.0292</td>
<td align="right">0.9781</td>
</tr>
</tbody>
</table>
<p>This is the skewness test of normality in the case of large sample, as can be seen from the table above, we can find the estimates are not very accurate when sample size is very large.</p>
</div>
<div id="estimate-against-symmetric-betaαα-distributions" class="section level4">
<h4>Estimate against symmetric Beta(α,α) distributions</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>alpha1 &lt;-<span class="st"> </span><span class="dv">4</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>alpha2 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>n &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>m &lt;-<span class="st"> </span><span class="dv">1500</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>)) </span>
<span id="cb24-7"><a href="#cb24-7"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb24-8"><a href="#cb24-8"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon </span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb24-13"><a href="#cb24-13"></a>sktests &lt;-<span class="st"> </span>xbar &lt;-<span class="st"> </span>m3 &lt;-<span class="st"> </span>m2 &lt;-<span class="st"> </span>sk &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>alpha &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(alpha1, alpha2), <span class="dt">replace =</span> <span class="ot">TRUE</span>, </span>
<span id="cb24-16"><a href="#cb24-16"></a>                <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb24-17"><a href="#cb24-17"></a>x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, alpha, alpha)</span>
<span id="cb24-18"><a href="#cb24-18"></a>xbar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb24-19"><a href="#cb24-19"></a>m3[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar[i])<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb24-20"><a href="#cb24-20"></a>m2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb24-21"><a href="#cb24-21"></a>sk[i] &lt;-<span class="st"> </span>m3[i] <span class="op">/</span><span class="st"> </span>((m2[i])<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb24-22"><a href="#cb24-22"></a>sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(sk[i]) <span class="op">&gt;=</span><span class="st"> </span>cv) }</span>
<span id="cb24-23"><a href="#cb24-23"></a>        pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb24-24"><a href="#cb24-24"></a>}</span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co">#plot power vs epsilon </span></span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon)) </span>
<span id="cb24-28"><a href="#cb24-28"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb24-29"><a href="#cb24-29"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors </span></span>
<span id="cb24-30"><a href="#cb24-30"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb24-31"><a href="#cb24-31"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The estimates of the power of the skewness test of normality against symmetric Beta(α,α) distributions can be seen from the figure above.The entire image is increasing before 0.8, and basically a downward trend between 0.8 and 1.</p>
</div>
<div id="heavy-tailed-symmetric-alternatives" class="section level4">
<h4>Heavy-tailed symmetric alternatives</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">4</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>n &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>m &lt;-<span class="st"> </span><span class="dv">1500</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>)) </span>
<span id="cb25-7"><a href="#cb25-7"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb25-8"><a href="#cb25-8"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon </span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb25-13"><a href="#cb25-13"></a>sktests &lt;-<span class="st"> </span>xbar &lt;-<span class="st"> </span>m3 &lt;-<span class="st"> </span>m2 &lt;-<span class="st"> </span>sk &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb25-15"><a href="#cb25-15"></a>nn &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(n1, n2), <span class="dt">replace =</span> <span class="ot">TRUE</span>, </span>
<span id="cb25-16"><a href="#cb25-16"></a>                <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb25-17"><a href="#cb25-17"></a>x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, nn)</span>
<span id="cb25-18"><a href="#cb25-18"></a>xbar[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb25-19"><a href="#cb25-19"></a>m3[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar[i])<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb25-20"><a href="#cb25-20"></a>m2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar[i])<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-21"><a href="#cb25-21"></a>sk[i] &lt;-<span class="st"> </span>m3[i] <span class="op">/</span><span class="st"> </span>((m2[i])<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb25-22"><a href="#cb25-22"></a>sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(sk[i]) <span class="op">&gt;=</span><span class="st"> </span>cv) }</span>
<span id="cb25-23"><a href="#cb25-23"></a>        pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb25-24"><a href="#cb25-24"></a>}</span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="co">#plot power vs epsilon </span></span>
<span id="cb25-26"><a href="#cb25-26"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb25-27"><a href="#cb25-27"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon)) </span>
<span id="cb25-28"><a href="#cb25-28"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb25-29"><a href="#cb25-29"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors </span></span>
<span id="cb25-30"><a href="#cb25-30"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb25-31"><a href="#cb25-31"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Similarly,we have obtained corresponding estimates in the case of t distribution, which can be seen from the above figure. By comparing the above two figures, we can find the results are different for heavy-tailed symmetric alternatives such as t(v) and the entire image is basically showing a downward trend.</p>
</div>
</div>
<div id="section-12" class="section level3">
<h3>6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at signiﬁcance level <span class="math inline">\(\hat{\alpha}\doteq0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="solution-12" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb26-2"><a href="#cb26-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb26-3"><a href="#cb26-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb26-4"><a href="#cb26-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb26-5"><a href="#cb26-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb26-8"><a href="#cb26-8"></a>}</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a></span>
<span id="cb26-11"><a href="#cb26-11"></a></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>power1 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb26-17"><a href="#cb26-17"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb26-18"><a href="#cb26-18"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="kw">count5test</span>(x, y)</span>
<span id="cb26-20"><a href="#cb26-20"></a>}))</span>
<span id="cb26-21"><a href="#cb26-21"></a></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="kw">print</span>(power1)</span></code></pre></div>
<pre><code>## [1] 0.298</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb28-2"><a href="#cb28-2"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="kw">var.test</span>(x, y, <span class="dt">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb28-4"><a href="#cb28-4"></a>         <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>),</span>
<span id="cb28-5"><a href="#cb28-5"></a>         <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x and y
## F = 0.47307, num df = 19, denom df = 19, p-value = 0.1114
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.1872473 1.1951907
## sample estimates:
## ratio of variances 
##           0.473071</code></pre>
<p>0.298 The empirical power of the test is 0.298(<span class="math inline">\(se\leq0.005\)</span>) against the alternative <span class="math inline">\(\sigma_1=1,\sigma_2=1.5\)</span> with <span class="math inline">\(n_1=20,n_2=20\)</span>. And the <span class="math inline">\(F\)</span> test value is 0.11472,p-value &lt; 2.2e-16.</p>
</div>
<div id="c" class="section level3">
<h3>6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is deﬁned by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3.\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3,\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are signiﬁcant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
</div>
<div id="solution-13" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) <span class="co">#crit. values for each n</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-6"><a href="#cb30-6"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb30-7"><a href="#cb30-7"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb30-9"><a href="#cb30-9"></a>}</span>
<span id="cb30-10"><a href="#cb30-10"></a></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb30-13"><a href="#cb30-13"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb30-15"><a href="#cb30-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb30-16"><a href="#cb30-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb30-18"><a href="#cb30-18"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i])</span>
<span id="cb30-19"><a href="#cb30-19"></a>    <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv[i] )</span>
<span id="cb30-21"><a href="#cb30-21"></a>  }</span>
<span id="cb30-22"><a href="#cb30-22"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb30-23"><a href="#cb30-23"></a>}</span>
<span id="cb30-24"><a href="#cb30-24"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>)))) </span>
<span id="cb30-25"><a href="#cb30-25"></a><span class="kw">round</span>(cv, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1.1355 0.9268 0.7943 0.6398 0.4660 0.2134</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb32-5"><a href="#cb32-5"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb32-6"><a href="#cb32-6"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) <span class="co">#critical value for the skewness test</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="co">#for each epsilon</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb32-11"><a href="#cb32-11"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb32-13"><a href="#cb32-13"></a>    <span class="co">#for each replicate</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>    sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb32-15"><a href="#cb32-15"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb32-16"><a href="#cb32-16"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb32-17"><a href="#cb32-17"></a>  }</span>
<span id="cb32-18"><a href="#cb32-18"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb32-19"><a href="#cb32-19"></a>} </span>
<span id="cb32-20"><a href="#cb32-20"></a></span>
<span id="cb32-21"><a href="#cb32-21"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb32-24"><a href="#cb32-24"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb32-26"><a href="#cb32-26"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># initialize input and output</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb33-3"><a href="#cb33-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span> <span class="co">#try smaller m for a trial run</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>epsilon &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>test1 &lt;-<span class="st"> </span>test2 &lt;-<span class="st"> </span>test3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb33-12"><a href="#cb33-12"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb33-13"><a href="#cb33-13"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb33-14"><a href="#cb33-14"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb33-15"><a href="#cb33-15"></a>} </span>
<span id="cb33-16"><a href="#cb33-16"></a></span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb33-19"><a href="#cb33-19"></a></span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="co"># estimate power</span></span>
<span id="cb33-21"><a href="#cb33-21"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb33-22"><a href="#cb33-22"></a>  e &lt;-<span class="st"> </span>epsilon</span>
<span id="cb33-23"><a href="#cb33-23"></a>  sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb33-24"><a href="#cb33-24"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb33-25"><a href="#cb33-25"></a>  test1[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb33-26"><a href="#cb33-26"></a>  test2[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">shapiro.test</span>(x)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</span>
<span id="cb33-27"><a href="#cb33-27"></a>  test3[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">mvnorm.etest</span>(x, <span class="dt">R=</span><span class="dv">200</span>)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</span>
<span id="cb33-28"><a href="#cb33-28"></a>}</span>
<span id="cb33-29"><a href="#cb33-29"></a><span class="kw">print</span>(<span class="kw">c</span>(epsilon, <span class="kw">mean</span>(test1), <span class="kw">mean</span>(test2), <span class="kw">mean</span>(test3)))</span></code></pre></div>
<pre><code>## [1] 0.1000 0.8224 0.9060 0.8964</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">detach</span>(package<span class="op">:</span>energy)</span></code></pre></div>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say,0.651 for one method and 0.676 for another method. Can we say the powers are diﬀerent at 0.05 level?</p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li><p>The corresponding hypothesis test problem is: <span class="math inline">\(H_0\)</span>: method 1 has the same power as method2. <span class="math inline">\(H_1\)</span>: the powers of method 1 and method 2 are different.</p></li>
<li><p>I think we should use paired-t test. Because firstly, there is no evidence showing that the variance of the power of two methods are the same, which makes it questionable to use Z-test. Secondly, since the sample of two methods are not independent(both of them use the same data in one time), we can not use two-sample t test as well. Also, we have quantitative samples, which are not suitable for Mcnemar test.But for paired-t test, we can compare the power of two methods in each simulation and find out whether there are significant difference.</p></li>
<li><p>To test my hypothesis, I need several repeatment of the process that estimate the empirical power. And in order to make the paired-t test reasonable, I need to know whether the difference of the two methods follows normal distribution.</p></li>
</ol>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.1, 7.5, 7.8, and 7.11 (pages 212-213, Statistical Computating with R).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-13" class="section level3">
<h3>7.1</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="solution-14" class="section level3">
<h3>Solution:</h3>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">data</span>(law,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>n&lt;-<span class="kw">nrow</span>(law)</span>
<span id="cb36-3"><a href="#cb36-3"></a>LSAT&lt;-law<span class="op">$</span>LSAT</span>
<span id="cb36-4"><a href="#cb36-4"></a>GPA&lt;-law<span class="op">$</span>GPA</span>
<span id="cb36-5"><a href="#cb36-5"></a>theta.hat&lt;-<span class="kw">cor</span>(LSAT,GPA)</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co"># jackknife estimate of bias</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>theta.jack&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb36-10"><a href="#cb36-10"></a>  theta.jack[i]&lt;-<span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])</span>
<span id="cb36-11"><a href="#cb36-11"></a>  bias&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb36-12"><a href="#cb36-12"></a>}</span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="kw">print</span>(bias)</span></code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># jackknife estimate of standard error</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>se&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<p>The Jackknife estimate of bias is -0.006473623.And the Jackknife estimate of standard error is 0.1425186.</p>
</div>
<div id="section-14" class="section level3">
<h3>7.5</h3>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="solution-15" class="section level3">
<h3>Solution:</h3>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="kw">data</span>(aircondit, <span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>x&lt;-aircondit<span class="op">$</span>hours</span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="kw">qqnorm</span>(x);</span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="kw">qqline</span>(x);</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQkLaQtpCQttuQ27aQ2/+2ZgC2Zjq2ZpC2kGa225C227a22/+2/7a2///bkDrbkGbbtmbbtpDb25Db27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v////ul9uRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANjklEQVR4nO1di3bjthG9dlaN3SZpK2X7SrN2m7bmtul21Wy2qeW1+f9fFeJJUCLAAQlqhqbvOZJp8GLmcoQXSRBE/YIkwC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDown+kKuGn+PO5wlZ336Rabe//Ph98B+PLNfYdxkriHwVfvjvLbDP98ny2jnjtASuTkAD2+tkf+6l1L6El0AcLFXU+APr2+FBggVYSmBqjZdGgPsS/RB6jJehqgCiID1IhyAVJV4rNvlOo9Lv72Gpf/bnZ8+AIXb+r/XuPVneaocvHVXSdAzXFfqIr04RrYOtt9iXsTgk+7pgi5/N5p1Q0wHZgQgQFoTVsXoL37cd3m5qed/cG/cOIPPVWk2brQwVOGglJ1mmgDpOLvAtQ6lRmgy983mkyAHq6VzL3+vZvvzbv6f82O5r8fGuFvzI7mqD6/V8xtEKCghlYuKv2JNkAfd81fkz90KrKKXX7fHKw5GKtP/9n77q2Rb751VBQ+/qspT1dBgPweUzTqeOJpGxQ6lRmg983v+49dcMD6cOwxmcj5AtYc8dNfzAEmAqSKHTY/JgPkqmjHqdAANYf3CxUBVycOqvDEAqS6plfffdx1AuSasN+q49UV1jRfYaLxZwN08Rs3Duo4FRogo5pYgkxheewGyLTHTeLFH2AOuvnz/26i8bfvDgOWUYJqfUAnbVB/gPQvfdxImx69GeeZPrGOJ54EaAltkCn4J71YtARt7j/ddtsgE+J2jBBPPA1Qj9NsYPTxD8IESB3KyTgo3gadNNK1LSe6efnGR6gn8TRAodODyHGQEnRAMJL+s9pK9mKv/r734xgLe176x3Ao3ZPYE6DA6dPb7skcFcjPwoant7++pyUWBOY0/hwAbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gG/9bjb6rlfs96GWx7gt6rN/cP1VV3lT0l91oDbeNzd1Ac0n3GzRJ4t4DZUgCo1eeclQB3Ab1VXjzs1g+ulinUAv/VoJmC/xKcLFDa3GHAFqKy5GWBjAzK/3dRTuqttlJr2mvnDcAHBh5zB4HBxt1eN9KgInZqTCbhv5OWo1ay+ZiCt5oRO6ubJfpkA9428HLUZB6kATRsokv0yAe4beTnqtgRVk07GyH65gHpiG7TXD+JM8i8b03oxjJyO3mdONlCcyGJuPqA4kcXcfEBxooZ7miLa0+WZYwTyiMHDM6knPvbusYgDIsNJsl9uoDixNiMBi31kMJBjjhUoTqzNWNIiNpzMMccKFCfWqy5BzSmqb4aSbZAtQi9tUAQuitHTkTxzjEA28fFrM4Z+3ierHsgmugA978sdHsgkVu04KHXBbLUDxbotQSm8DBTTWHE3rzBYfRIDxeVctHdAPrEabJ3XXYIotzNWPVAM6k8cax4olrkrT/bLDeQTD9Mu12f65QayiZSTVYuH62goyX65geLEmnTdMcccK1CcqGA7r5WWIFc+UlVMzUFbbYCqzf3+KnXwhnVxt9IAqYHiQc3uGLg335ywrjVAN/XDr97rTxIP15+tMkDqREtd8hgMkDqrXWOA9KXEajtYxQr55QZGECu9oui0eeRkv9xAcSKLufmA4kQWc/MB2cSMc7ESfrmBscSJD/uQ/XIDo4nTnhcj++UGRhNHFaFVXLS3eLmzmiZOfF6M7JcbyCYOXo8v65cbKE5kMTcfUJzIYm4+IJto7jyrhzKnPA9F9ssN5BLtxI39y0i6n3hoX2/y0ov1EP1t1eBlS31Y7QQqf2N+v/nhZaZ9D5EwRbxe9fSXYOZC4mR1QTPtB88KB3afEH0j/fDL+FTF5ZQg1ENS0nt7iL6bT903XMoEKgTfSQrZVu06qIEzsYVMoELwnaSQbRVDYXMjgeA7SSHbKobC5sYCdfE2iIbFDBSL92I0rHegSMNyuvlhoDixXv1M++H1g1ZeggjrBy1loEgAsomk9YMWMlAcBr0t8MR1rB+koZpKkMluYyXrB7kREsh8v0VZP0i9t1Tvj1VEsl8etN0sEqxulnZzeP2gvX7Bsn6t7PIC1B2EIEY7yZbhwnTzT7eJpjzH3DlxMkJDH6s3Z4YXN1BUU86XFKC+8etpSixzhiM/UKyulhOgyOi+NzFOpK4fZPfFJ8OS/Z4H8XOfWPp4oobr455uhQWotxalRoOJXSOJLOZy3HZdD503p/f2E3U9m7jmP9lvUeDIN+GqwiDhlGju/OynLaRI9lsUCL9p11wonC7x6db34dS8U/wWBdw3/YIUlRecrC55/SDlNu9yHZnqia4ELfNpn+yLmWR2SzTPzYtf7DY43+zZopvJJhLHiqX8TnGAzta4C+HkPGOMn89ca9dGof1GJz3fYHFi2spMdzXCuMBtuH8n+SNnbImU5+bL+SVbc5+jrdwLg32m84j6Ms9kkP3SjaEzEFRfpuRgkjtyTk8krR9Uzi/dGGIj5UkVmpzVE6dNIM/2SzeG4DMtKKe2s4ipyXfl/ZKtGYumUhXsA8iWWuLDtbhGOgxJ4R6SbMwTRS/RVX5WBNmeJwpspK3JWeaMkE16oqBGer6KFfjIJ4pppFGX7rIiTvKIYhYWMCbmqVjHXkoSz2ZOmZg5OvWyA+RPJOYE2X5L5D5ZNaXGVq0Jdoje8om0Rd5K+e3N6U7RZ69g4xpp2iJvhfyeZNRFZ3T2fH/ZRPIib8PmEiXgaJe/INa5YHgOkD15ImmRN9KjCO6T2N35N2iUI9lmANlTSyQs8kZ6FAFxAUe71EZ7dSeWaR6QXQXEwUXeaBPJERdwtKvboZ+jaT6WUpJYUx9FQNxuZ9f5250QZK9kYk1+FMF9ErvdoCdTQEGQ3Triw/VWNS0Ds1xpjyIM9GLBadZ5q1VHSCZRjw/Vzef0QHH6owh8IekCmUT9tLx+s8bERd4Wg7wA6Wd8zEXXiesE9tsnJp+dTIDJqfsn8yTUS4D6cuoAmeZn2rlYxD4x+exkAmxO1fLo6Yllbm6c2Kcln51MgM15uLgzC/oPvwJplH1a8tnJBLicB913P1yXrWDPKEBzIWK/P/nsZALG55xkvz/57GQCxuecZL8/+exkAsbnXAnALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDrALUA6wC1AOsAtQDown+l2noi5nZa4lhvesRwgZ1AzRfQDuRnIeNz5q7dDM4zVI/ukBZuzqJkiIsCYTBQcgllEA7eSzD1/d8cySc6gZoqIAWMyEXDAtlW0Txdse7/J0pPkDGqmiBgwKhcJrbbqy6b2x590MIXf0ZPkDGqmiBiQnYMMr83eUIqKM22KbVnS5AxqpogYkJuBjqNKH28DOkedJmdQM0XEgEx+Bo7ExCfWdOtNkpxBzRQRAzL5w9i7qn6sra+b1eRuyxsn18eNdJJqQBGRBDL5GfDazFHFS3en706TM6iZImJAJj8DQQeip2fF28fO6C9NzqBmiogAuRno0NrMbJEKGFoCtZ1akiZnUDNF9APZOVYGcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA7MZrldHPY/1JWYDzf9qza3iQcMLHHkjZRZ/nnuEmSm41C1Rnluh3kxnl4LatDIKgNkJ04lp4ktM0B/uoZ9tZKbfWY2Hr/+q5rIbJLVovqbn3aOF8xYsQfr32Su1+tz6Z7zbVOnb7wRvc/50+v1jwsYJgchBRegptnY249dLO1Gv/LXTD11yb7pMG8E3vo1aWyA/Py5w+V7H6CWYxw4I/rl3tawX4BsBFAqFr1wAdrqeuFXcDIT6fSKM9tgYaf22ExJ0e+EUwdnA+Rnlh1MHFR6wHFOfIC84SmLRmHK8Q8iaIOaL3OAzUGYRsQeTe2T3bGFbcwBSAaoy9FR8QEKDEt9IdhRgGy/bwNkj6b2yT5Ario1Tcjl920J6q1iHc5RgJxhswat5DYoLEG164a6JcjywhKk/wZVrG2kN/fOZpfTV4IcqnHv/8SYTGR0A+R73qANugk65OM2SDcdh7aK6W7+6Xbzo27QTZPT5XQD1O3pR/b7GHfkRHQDZFZJU79k24vpTt0mq4P2vdjT7ZUpGNi2x1bpCKm1stTbvpqtmy7HtsxhL6YM66J0kF+CzLhEt5duHGSO3CVXR+MgPeW3sgVNwzYrDVmdyXxr2qCWo/v9o3GQKWKDZygxoEQczo63Bd6RQgTO5mmhALcA6QC3AOkAtwDpALcA6QC3AOkAtwDpALcA6QC3AOkAtwDpALcA6QC3AOkAtwDpALcA6QC3AOkAtwDpALcA6QC3AOkAtwDpALcA6QC3AOkAtwDpALcA6fgZr4fo2a4grDcAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(x, <span class="dt">R =</span> <span class="dv">2000</span>,</span>
<span id="cb41-2"><a href="#cb41-2"></a>                 <span class="dt">statistic =</span> <span class="cf">function</span>(x, i){</span>
<span id="cb41-3"><a href="#cb41-3"></a>                   <span class="kw">mean</span>(x[i])})</span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.4, 182.8 )   ( 25.5, 170.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 45.9, 190.7 )   ( 56.8, 230.9 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>From the outputs above,we know that the intervals are different.And the from the Q-Q plot,the data is obviously not normal,so the normal interval is not good.BCa performs well.</p>
</div>
<div id="section-15" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="solution-16" class="section level3">
<h3>Solution:</h3>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="kw">data</span>(scor, <span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb43-6"><a href="#cb43-6"></a>df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(scor)</span>
<span id="cb43-7"><a href="#cb43-7"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(df))<span class="op">$</span>value[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(df))<span class="op">$</span>value)</span>
<span id="cb43-8"><a href="#cb43-8"></a></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">#Jackknife estimate of bias and standard error</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>theta.jack&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb43-12"><a href="#cb43-12"></a>  x&lt;-df[<span class="op">-</span>i,]</span>
<span id="cb43-13"><a href="#cb43-13"></a>  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb43-14"><a href="#cb43-14"></a>  theta.jack[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</span>
<span id="cb43-15"><a href="#cb43-15"></a>}</span>
<span id="cb43-16"><a href="#cb43-16"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb43-17"><a href="#cb43-17"></a>se &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta.jack) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb43-18"><a href="#cb43-18"></a></span>
<span id="cb43-19"><a href="#cb43-19"></a><span class="kw">rbind</span>(bias,se)</span></code></pre></div>
<pre><code>##             [,1]
## bias 0.001069139
## se   0.049552307</code></pre>
<p>The Jackknife estimate of bias is 0.001069139.And the Jackknife estimate of standard error is 0.049552307.</p>
</div>
<div id="section-16" class="section level3">
<h3>7.11</h3>
<p>In Example 7.18, leave-one-out (<span class="math inline">\(n\)</span>-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="solution-17" class="section level3">
<h3>Solution:</h3>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">library</span>(DAAG);</span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>N &lt;-<span class="st"> </span><span class="kw">combn</span>(n, <span class="dv">2</span>) </span>
<span id="cb49-5"><a href="#cb49-5"></a>m&lt;-<span class="kw">dim</span>(N)[<span class="dv">2</span>]</span>
<span id="cb49-6"><a href="#cb49-6"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb49-11"><a href="#cb49-11"></a>  lto&lt;-N[,k]</span>
<span id="cb49-12"><a href="#cb49-12"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>lto]</span>
<span id="cb49-13"><a href="#cb49-13"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>lto] </span>
<span id="cb49-14"><a href="#cb49-14"></a>  </span>
<span id="cb49-15"><a href="#cb49-15"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb49-16"><a href="#cb49-16"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[lto]</span>
<span id="cb49-17"><a href="#cb49-17"></a>  e1[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[lto] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb49-18"><a href="#cb49-18"></a>  </span>
<span id="cb49-19"><a href="#cb49-19"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb49-20"><a href="#cb49-20"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[lto]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]           <span class="op">*</span><span class="st"> </span>chemical[lto]<span class="op">^</span><span class="dv">2</span> </span>
<span id="cb49-21"><a href="#cb49-21"></a>  e2[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[lto] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb49-22"><a href="#cb49-22"></a>  </span>
<span id="cb49-23"><a href="#cb49-23"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb49-24"><a href="#cb49-24"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[lto]</span>
<span id="cb49-25"><a href="#cb49-25"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb49-26"><a href="#cb49-26"></a>  e3[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[lto] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb49-27"><a href="#cb49-27"></a>  </span>
<span id="cb49-28"><a href="#cb49-28"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb49-29"><a href="#cb49-29"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[lto])</span>
<span id="cb49-30"><a href="#cb49-30"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb49-31"><a href="#cb49-31"></a>  e4[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[lto] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb49-32"><a href="#cb49-32"></a>}</span>
<span id="cb49-33"><a href="#cb49-33"></a></span>
<span id="cb49-34"><a href="#cb49-34"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1),<span class="kw">mean</span>(e2),<span class="kw">mean</span>(e3),<span class="kw">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model,would be the best fit for the data.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>model&lt;-<span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>),<span class="dt">data =</span> ironslag)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2), data = ironslag)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4335 -2.7006 -0.2754  2.5446 12.2665 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   24.49262    9.14657   2.678   0.0100 **
## chemical      -1.39334    0.88852  -1.568   0.1232   
## I(chemical^2)  0.05452    0.02081   2.620   0.0116 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.098 on 50 degrees of freedom
## Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 
## F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math display">\[\hat{Y}=24.49-1.39X+0.05X^2.\]</span></p>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercise 8.3 (page 243, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<p><strong>Note</strong>: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-17" class="section level3">
<h3>8.3</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="solution-18" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">100</span>; n2 &lt;-<span class="st"> </span><span class="dv">150</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a>m &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, s) {</span>
<span id="cb53-5"><a href="#cb53-5"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb53-6"><a href="#cb53-6"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb53-7"><a href="#cb53-7"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb53-8"><a href="#cb53-8"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb53-9"><a href="#cb53-9"></a><span class="co"># return 1 (reject) or 0 (do not reject H0) </span></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span>s))</span>
<span id="cb53-11"><a href="#cb53-11"></a>}</span>
<span id="cb53-12"><a href="#cb53-12"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1)</span>
<span id="cb53-13"><a href="#cb53-13"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2)</span>
<span id="cb53-14"><a href="#cb53-14"></a>s &lt;-<span class="st"> </span><span class="dv">5</span><span class="op">:</span><span class="dv">15</span></span>
<span id="cb53-15"><a href="#cb53-15"></a>R &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb53-16"><a href="#cb53-16"></a>q &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb53-17"><a href="#cb53-17"></a>alphahat &lt;-<span class="st"> </span>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(s))</span>
<span id="cb53-18"><a href="#cb53-18"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(s)) {</span>
<span id="cb53-19"><a href="#cb53-19"></a>  ss &lt;-<span class="st"> </span>s[j]</span>
<span id="cb53-20"><a href="#cb53-20"></a>  alphahat[j] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x, y, ss) </span>
<span id="cb53-21"><a href="#cb53-21"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb53-22"><a href="#cb53-22"></a>  K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2); n&lt;-<span class="kw">length</span>(x)</span>
<span id="cb53-23"><a href="#cb53-23"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb53-24"><a href="#cb53-24"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb53-25"><a href="#cb53-25"></a>  x1 &lt;-<span class="st"> </span>z[k]; y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb53-26"><a href="#cb53-26"></a>  x1 &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x1) </span>
<span id="cb53-27"><a href="#cb53-27"></a>  <span class="co">#centered by sample mean </span></span>
<span id="cb53-28"><a href="#cb53-28"></a>  y1 &lt;-<span class="st"> </span>y1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y1)</span>
<span id="cb53-29"><a href="#cb53-29"></a>  q[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1, y1, ss)</span>
<span id="cb53-30"><a href="#cb53-30"></a> }</span>
<span id="cb53-31"><a href="#cb53-31"></a> pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(alphahat[j], q))</span>
<span id="cb53-32"><a href="#cb53-32"></a>}</span>
<span id="cb53-33"><a href="#cb53-33"></a><span class="kw">plot</span>(s, pwr, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power value will decrease as the number of extreme samples increases when the sample is fixed.</p>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nnenergy-and-ball-methods-in-various-situations." class="section level3">
<h3>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</h3>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<p><strong>Note</strong>: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="solution-19" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">library</span>(RANN) </span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="kw">library</span>(boot)</span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<p>(1)(2):</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>Te &lt;-<span class="st"> </span><span class="cf">function</span>(z, x, sizes,k) {</span>
<span id="cb55-2"><a href="#cb55-2"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb55-3"><a href="#cb55-3"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb55-4"><a href="#cb55-4"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb55-5"><a href="#cb55-5"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb55-6"><a href="#cb55-6"></a>  z &lt;-<span class="st"> </span>z[x, ]</span>
<span id="cb55-7"><a href="#cb55-7"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb55-8"><a href="#cb55-8"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb55-9"><a href="#cb55-9"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb55-10"><a href="#cb55-10"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb55-11"><a href="#cb55-11"></a>  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>) </span>
<span id="cb55-12"><a href="#cb55-12"></a>  <span class="kw">return</span>((i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n))</span>
<span id="cb55-13"><a href="#cb55-13"></a>}</span>
<span id="cb55-14"><a href="#cb55-14"></a></span>
<span id="cb55-15"><a href="#cb55-15"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb55-16"><a href="#cb55-16"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb55-17"><a href="#cb55-17"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb55-18"><a href="#cb55-18"></a>n1&lt;-n2&lt;-<span class="dv">50</span></span>
<span id="cb55-19"><a href="#cb55-19"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb55-20"><a href="#cb55-20"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb55-21"><a href="#cb55-21"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb55-22"><a href="#cb55-22"></a>   boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Te,<span class="dt">R=</span><span class="dv">999</span>,</span>
<span id="cb55-23"><a href="#cb55-23"></a>   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb55-24"><a href="#cb55-24"></a>   ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb55-25"><a href="#cb55-25"></a>   p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb55-26"><a href="#cb55-26"></a>   <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb55-27"><a href="#cb55-27"></a>}</span>
<span id="cb55-28"><a href="#cb55-28"></a> p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb55-29"><a href="#cb55-29"></a> power.comp&lt;-<span class="cf">function</span>(mu1,mu2,sigma1,sigma2,alpha){</span>
<span id="cb55-30"><a href="#cb55-30"></a>   x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb55-31"><a href="#cb55-31"></a>   y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb55-32"><a href="#cb55-32"></a>   z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb55-33"><a href="#cb55-33"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb55-34"><a href="#cb55-34"></a></span>
<span id="cb55-35"><a href="#cb55-35"></a>   p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb55-36"><a href="#cb55-36"></a>   p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb55-37"><a href="#cb55-37"></a>   p.values[i,<span class="dv">3</span>] &lt;-<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb55-38"><a href="#cb55-38"></a>}</span>
<span id="cb55-39"><a href="#cb55-39"></a> pow&lt;-<span class="kw">apply</span>(p.values<span class="op">&lt;</span>alpha,<span class="dv">2</span>,mean)</span>
<span id="cb55-40"><a href="#cb55-40"></a> <span class="kw">names</span>(pow)&lt;-<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb55-41"><a href="#cb55-41"></a> <span class="kw">return</span>(pow)</span>
<span id="cb55-42"><a href="#cb55-42"></a> }</span>
<span id="cb55-43"><a href="#cb55-43"></a> </span>
<span id="cb55-44"><a href="#cb55-44"></a></span>
<span id="cb55-45"><a href="#cb55-45"></a><span class="kw">power.comp</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="fl">0.055</span>) <span class="co">#Unequal variances and equal expectations</span></span></code></pre></div>
<pre><code>##     NN energy   Ball 
##   1.00   0.00   0.95</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">power.comp</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="fl">0.02</span>) <span class="co">#Unequal variances and unequal expectations</span></span></code></pre></div>
<pre><code>##     NN energy   Ball 
##      1      1      1</code></pre>
<p>(3)Consider the t distribution with 1 df:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>n1&lt;-n2&lt;-<span class="dv">50</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb59-6"><a href="#cb59-6"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb59-7"><a href="#cb59-7"></a></span>
<span id="cb59-8"><a href="#cb59-8"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb59-9"><a href="#cb59-9"></a>   boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Te,<span class="dt">R=</span><span class="dv">999</span>,</span>
<span id="cb59-10"><a href="#cb59-10"></a>   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb59-11"><a href="#cb59-11"></a>   ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb59-12"><a href="#cb59-12"></a>   p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb59-13"><a href="#cb59-13"></a>   <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb59-14"><a href="#cb59-14"></a>}</span>
<span id="cb59-15"><a href="#cb59-15"></a> pt.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb59-16"><a href="#cb59-16"></a></span>
<span id="cb59-17"><a href="#cb59-17"></a> </span>
<span id="cb59-18"><a href="#cb59-18"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb59-19"><a href="#cb59-19"></a>   x &lt;-<span class="st"> </span><span class="kw">rt</span>(n1,<span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb59-20"><a href="#cb59-20"></a>   y &lt;-<span class="st"> </span><span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb59-21"><a href="#cb59-21"></a>   z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb59-22"><a href="#cb59-22"></a>   pt.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb59-23"><a href="#cb59-23"></a>   pt.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb59-24"><a href="#cb59-24"></a>   pt.values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb59-25"><a href="#cb59-25"></a>}</span>
<span id="cb59-26"><a href="#cb59-26"></a>alpha.t &lt;-<span class="st"> </span><span class="fl">0.2</span></span>
<span id="cb59-27"><a href="#cb59-27"></a>pow.t&lt;-<span class="kw">apply</span>(pt.values<span class="op">&lt;</span>alpha.t,<span class="dv">2</span>,mean)</span>
<span id="cb59-28"><a href="#cb59-28"></a><span class="kw">names</span>(pow.t)&lt;-<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb59-29"><a href="#cb59-29"></a>pow.t</span></code></pre></div>
<pre><code>##     NN energy   Ball 
##   0.20   0.23   0.19</code></pre>
<p>Consider the bimodel distribution: Set <span class="math display">\[X\sim 0.5N(0,1)+0.5N(1,1)\]</span> And <span class="math display">\[Y\sim 0.5N(0,1.5)+0.5N(1,1.5)\]</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a> pb.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb61-3"><a href="#cb61-3"></a>   x &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">rnorm</span>(n1,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb61-4"><a href="#cb61-4"></a>   y &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="fl">1.5</span>)<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">rnorm</span>(n1,<span class="dv">1</span>,<span class="fl">1.5</span>)</span>
<span id="cb61-5"><a href="#cb61-5"></a>   z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb61-6"><a href="#cb61-6"></a>   pb.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb61-7"><a href="#cb61-7"></a>   pb.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb61-8"><a href="#cb61-8"></a>   pb.values[i,<span class="dv">3</span>] &lt;-<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb61-9"><a href="#cb61-9"></a>}</span>
<span id="cb61-10"><a href="#cb61-10"></a> alpha.b &lt;-<span class="st"> </span><span class="fl">0.2</span></span>
<span id="cb61-11"><a href="#cb61-11"></a> pow.b&lt;-<span class="kw">apply</span>(pb.values<span class="op">&lt;</span>alpha.b,<span class="dv">2</span>,mean)</span>
<span id="cb61-12"><a href="#cb61-12"></a> <span class="kw">names</span>(pow.b)&lt;-<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb61-13"><a href="#cb61-13"></a> pow.b</span></code></pre></div>
<pre><code>##     NN energy   Ball 
##   0.54   0.72   0.81</code></pre>
<p>(4)Consider Unbalanced samples,set<span class="math inline">\(n_1=10,n_2=100\)</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a>n1&lt;-<span class="dv">10</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>n2&lt;-<span class="dv">100</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb63-5"><a href="#cb63-5"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb63-6"><a href="#cb63-6"></a>m&lt;-<span class="dv">50</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>power.comp&lt;-<span class="cf">function</span>(mu1,mu2,s1,s2,a){</span>
<span id="cb63-8"><a href="#cb63-8"></a>   x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,s1)</span>
<span id="cb63-9"><a href="#cb63-9"></a>   y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,s2)</span>
<span id="cb63-10"><a href="#cb63-10"></a>   z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb63-11"><a href="#cb63-11"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-12"><a href="#cb63-12"></a>      </span>
<span id="cb63-13"><a href="#cb63-13"></a>   pt.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,<span class="dv">3</span>)<span class="op">$</span>p.value</span>
<span id="cb63-14"><a href="#cb63-14"></a>   pt.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb63-15"><a href="#cb63-15"></a>   pt.values[i,<span class="dv">3</span>] &lt;-<span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb63-16"><a href="#cb63-16"></a>}</span>
<span id="cb63-17"><a href="#cb63-17"></a> alpha &lt;-<span class="st"> </span>a</span>
<span id="cb63-18"><a href="#cb63-18"></a> pow&lt;-<span class="kw">apply</span>(pt.values<span class="op">&lt;</span>a,<span class="dv">2</span>,mean)</span>
<span id="cb63-19"><a href="#cb63-19"></a> <span class="kw">names</span>(pow)&lt;-<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb63-20"><a href="#cb63-20"></a> <span class="kw">return</span>(pow)</span>
<span id="cb63-21"><a href="#cb63-21"></a>}</span>
<span id="cb63-22"><a href="#cb63-22"></a><span class="kw">power.comp</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##     NN energy   Ball 
##   0.55   0.07   0.56</code></pre>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercise 9.4 (pages 277, Statistical Computing with R).</p>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<p>Exercises 11.4 (pages 353, Statistical Computing with R)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="section-18" class="section level3">
<h3>9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="solution-20" class="section level3">
<h3>Solution:</h3>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}, x\sim\mathbb{R}\)</span>.</p>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>lap.f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="co"># prop density function of Laplace distribution</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</span>
<span id="cb65-4"><a href="#cb65-4"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>rw.Me &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){ </span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="co"># function to generate a random walk metropolis chain</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </span>
<span id="cb66-4"><a href="#cb66-4"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0 </span>
<span id="cb66-5"><a href="#cb66-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N) </span>
<span id="cb66-6"><a href="#cb66-6"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span> </span>
<span id="cb66-7"><a href="#cb66-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){ </span>
<span id="cb66-8"><a href="#cb66-8"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) </span>
<span id="cb66-9"><a href="#cb66-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap.f</span>(y)<span class="op">/</span><span class="kw">lap.f</span>(x[i<span class="dv">-1</span>]))){</span>
<span id="cb66-10"><a href="#cb66-10"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb66-11"><a href="#cb66-11"></a>    }<span class="cf">else</span>{ </span>
<span id="cb66-12"><a href="#cb66-12"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>] </span>
<span id="cb66-13"><a href="#cb66-13"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span> } </span>
<span id="cb66-14"><a href="#cb66-14"></a>    } </span>
<span id="cb66-15"><a href="#cb66-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k)) </span>
<span id="cb66-16"><a href="#cb66-16"></a>} </span>
<span id="cb66-17"><a href="#cb66-17"></a></span>
<span id="cb66-18"><a href="#cb66-18"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span> </span>
<span id="cb66-19"><a href="#cb66-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb66-20"><a href="#cb66-20"></a></span>
<span id="cb66-21"><a href="#cb66-21"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span> </span>
<span id="cb66-22"><a href="#cb66-22"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Me</span>(sigma[<span class="dv">1</span>], x0, N) </span>
<span id="cb66-23"><a href="#cb66-23"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Me</span>(sigma[<span class="dv">2</span>], x0, N) </span>
<span id="cb66-24"><a href="#cb66-24"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Me</span>(sigma[<span class="dv">3</span>], x0, N) </span>
<span id="cb66-25"><a href="#cb66-25"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Me</span>(sigma[<span class="dv">4</span>], x0, N)</span></code></pre></div>
<p>Compare the chains generated when different variances are used for the proposal distribution.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw">plot</span>((<span class="dv">1</span><span class="op">:</span>N),rw1<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">&quot;=&quot;</span>,<span class="fl">0.05</span>)))</span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="kw">plot</span>((<span class="dv">1</span><span class="op">:</span>N),rw2<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">&quot;=&quot;</span>,<span class="fl">0.5</span>)))</span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="kw">plot</span>((<span class="dv">1</span><span class="op">:</span>N),rw3<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">&quot;=&quot;</span>,<span class="dv">2</span>)))</span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="kw">plot</span>((<span class="dv">1</span><span class="op">:</span>N),rw4<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">&quot;=&quot;</span>,<span class="dv">16</span>)))</span></code></pre></div>
<p>Compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>rw.k &lt;-<span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</span>
<span id="cb68-2"><a href="#cb68-2"></a>rate.acceptance &lt;-<span class="st"> </span>N<span class="op">/</span>(rw.k<span class="op">+</span>N)</span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="kw">rbind</span>(sigma,rate.acceptance)</span></code></pre></div>
<pre><code>##                     [,1]      [,2]      [,3]       [,4]
## sigma           0.050000 0.5000000 2.0000000 16.0000000
## rate.acceptance 0.984252 0.8532423 0.6863418  0.5281225</code></pre>
<p>We will find that as the variance becomes larger, the Markov chain converges quickly, but the acceptance rate will also drop quickly.</p>
</div>
<div id="extensions" class="section level3">
<h3>Extensions</h3>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="solution-21" class="section level3">
<h3>Solution:</h3>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb70-5"><a href="#cb70-5"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb70-6"><a href="#cb70-6"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb70-7"><a href="#cb70-7"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb70-8"><a href="#cb70-8"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb70-9"><a href="#cb70-9"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb70-10"><a href="#cb70-10"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb70-11"><a href="#cb70-11"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb70-12"><a href="#cb70-12"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb70-13"><a href="#cb70-13"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb70-14"><a href="#cb70-14"></a>}</span></code></pre></div>
<p>Since several chains are to be generated, the M-H sampler is written as a function normal.chain.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>normal.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="co">#generates a Metropolis chain for the standard Laplace distribution</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb71-5"><a href="#cb71-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb71-6"><a href="#cb71-6"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb71-7"><a href="#cb71-7"></a>  <span class="kw">set.seed</span>(<span class="dv">1122</span>)</span>
<span id="cb71-8"><a href="#cb71-8"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb71-9"><a href="#cb71-9"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb71-10"><a href="#cb71-10"></a>    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb71-11"><a href="#cb71-11"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb71-12"><a href="#cb71-12"></a>    r1 &lt;-<span class="st"> </span><span class="kw">lap.f</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb71-13"><a href="#cb71-13"></a>    r2 &lt;-<span class="st"> </span><span class="kw">lap.f</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb71-14"><a href="#cb71-14"></a>    r &lt;-<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb71-15"><a href="#cb71-15"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r) </span>
<span id="cb71-16"><a href="#cb71-16"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb71-17"><a href="#cb71-17"></a>    <span class="cf">else</span></span>
<span id="cb71-18"><a href="#cb71-18"></a>      x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb71-19"><a href="#cb71-19"></a>    }</span>
<span id="cb71-20"><a href="#cb71-20"></a>  <span class="kw">return</span>(x)</span>
<span id="cb71-21"><a href="#cb71-21"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span>   <span class="co">#parameter of proposal distribution</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>       <span class="co">#number of chains to generate</span></span>
<span id="cb72-3"><a href="#cb72-3"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span>   <span class="co">#length of chains</span></span>
<span id="cb72-4"><a href="#cb72-4"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb72-5"><a href="#cb72-5"></a></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb72-7"><a href="#cb72-7"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb72-8"><a href="#cb72-8"></a></span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="co">#generate the chains</span></span>
<span id="cb72-10"><a href="#cb72-10"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb72-12"><a href="#cb72-12"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">normal.chain</span>(sigma, n, x0[i])</span>
<span id="cb72-13"><a href="#cb72-13"></a></span>
<span id="cb72-14"><a href="#cb72-14"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb72-15"><a href="#cb72-15"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb72-16"><a href="#cb72-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb72-17"><a href="#cb72-17"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb72-18"><a href="#cb72-18"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb72-19"><a href="#cb72-19"></a></span>
<span id="cb72-20"><a href="#cb72-20"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb72-21"><a href="#cb72-21"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb72-22"><a href="#cb72-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb72-23"><a href="#cb72-23"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb72-24"><a href="#cb72-24"></a>       <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb72-25"><a href="#cb72-25"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb72-26"><a href="#cb72-26"></a></span>
<span id="cb72-27"><a href="#cb72-27"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb72-28"><a href="#cb72-28"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb72-29"><a href="#cb72-29"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb72-30"><a href="#cb72-30"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb72-31"><a href="#cb72-31"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb72-32"><a href="#cb72-32"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p>For comparison the simulation is repeated, where the variance of the proposal distribution is <span class="math inline">\(\sigma^2=1\)</span>.The plot of <span class="math inline">\(\hat{R}\)</span> is shown in the figure. The value of <span class="math inline">\(\hat{R}\)</span> is below <span class="math inline">\(1.2\)</span> is within 4000 iterations.</p>
</div>
<div id="section-19" class="section level3">
<h3>11.4</h3>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_k(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\]</span> for <span class="math inline">\(k=4:25,100,500,1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="solution-22" class="section level3">
<h3>Solution:</h3>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>cupper &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb73-3"><a href="#cb73-3"></a>}</span>
<span id="cb73-4"><a href="#cb73-4"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(u){</span>
<span id="cb73-5"><a href="#cb73-5"></a>  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb73-6"><a href="#cb73-6"></a>}</span>
<span id="cb73-7"><a href="#cb73-7"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(u){</span>
<span id="cb73-8"><a href="#cb73-8"></a>  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb73-9"><a href="#cb73-9"></a>}</span>
<span id="cb73-10"><a href="#cb73-10"></a></span>
<span id="cb73-11"><a href="#cb73-11"></a></span>
<span id="cb73-12"><a href="#cb73-12"></a>kt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</span>
<span id="cb73-13"><a href="#cb73-13"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(kt)</span>
<span id="cb73-14"><a href="#cb73-14"></a>A  &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb73-15"><a href="#cb73-15"></a></span>
<span id="cb73-16"><a href="#cb73-16"></a></span>
<span id="cb73-17"><a href="#cb73-17"></a>sol &lt;-<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb73-18"><a href="#cb73-18"></a>   <span class="co"># the toot of sol2 is A(k)</span></span>
<span id="cb73-19"><a href="#cb73-19"></a>   <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">cupper</span>(k<span class="dv">-1</span>,a),k<span class="dv">-1</span>)<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="kw">pt</span>(<span class="kw">cupper</span>(k,a),k)</span>
<span id="cb73-20"><a href="#cb73-20"></a>  }</span>
<span id="cb73-21"><a href="#cb73-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb73-22"><a href="#cb73-22"></a>   k &lt;-<span class="st"> </span>kt[i]</span>
<span id="cb73-23"><a href="#cb73-23"></a>   A[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(sol,<span class="kw">c</span>(<span class="fl">1e-5</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">1e-5</span>))<span class="op">$</span>root</span>
<span id="cb73-24"><a href="#cb73-24"></a> }</span>
<span id="cb73-25"><a href="#cb73-25"></a></span>
<span id="cb73-26"><a href="#cb73-26"></a><span class="kw">cbind</span>(<span class="dt">df.t=</span>kt,<span class="dt">root.ex11.4=</span>A</span>
<span id="cb73-27"><a href="#cb73-27"></a>      </span>
<span id="cb73-28"><a href="#cb73-28"></a>      )</span></code></pre></div>
<pre><code>##       df.t root.ex11.4
##  [1,]    4    1.492103
##  [2,]    5    1.533549
##  [3,]    6    1.562768
##  [4,]    7    1.584421
##  [5,]    8    1.601182
##  [6,]    9    1.614523
##  [7,]   10    1.625387
##  [8,]   11    1.634409
##  [9,]   12    1.642025
## [10,]   13    1.648540
## [11,]   14    1.654177
## [12,]   15    1.659098
## [13,]   16    1.663451
## [14,]   17    1.667288
## [15,]   18    1.670736
## [16,]   19    1.673841
## [17,]   20    1.676588
## [18,]   21    1.679139
## [19,]   22    1.681461
## [20,]   23    4.795822
## [21,]   24    4.898969
## [22,]   25    4.999990
## [23,]  100    9.999990</code></pre>
</div>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ul>
<li>A-B-O blood type problem
<ul>
<li>Let the three alleles be A, B, and O.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">AA</th>
<th align="center">BB</th>
<th align="center">OO</th>
<th align="center">AO</th>
<th align="center">BO</th>
<th align="center">AB</th>
<th align="center">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Frequency</td>
<td align="center"><span class="math inline">\(p^2\)</span></td>
<td align="center"><span class="math inline">\(q^2\)</span></td>
<td align="center"><span class="math inline">\(r^2\)</span></td>
<td align="center">2pr</td>
<td align="center">2qr</td>
<td align="center">2pq</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">Count</td>
<td align="center"><span class="math inline">\(n_{AA}\)</span></td>
<td align="center"><span class="math inline">\(n_{BB}\)</span></td>
<td align="center"><span class="math inline">\(n_{OO}\)</span></td>
<td align="center"><span class="math inline">\(n_{AO}\)</span></td>
<td align="center"><span class="math inline">\(n_{BO}\)</span></td>
<td align="center"><span class="math inline">\(n_{AB}\)</span></td>
<td align="center">n</td>
</tr>
</tbody>
</table>
<ul>
<li>Observed <a href="data:$n_%7BA\cdot%7D=n_%7BAA%7D+n_%7BAO%7D=444(A-type),$" class="uri">data:$n_{A\cdot}=n_{AA}+n_{AO}=444(A-type),$</a> <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=132(B-type),n_{OO}=361(O-type),\)</span> <span class="math inline">\(n_{AB}=63(AB-type).\)</span></li>
<li>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</li>
<li>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ul></li>
<li>Exercises 3 (page 204, Advanced R).</li>
<li>Excecises 3 and 6 (page 213-214, Advanced R). Note: the anonymous function is defined in Section 10.2 (page 181, Advanced R)</li>
</ul>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="a-b-o-blood-type-problem" class="section level3">
<h3>A-B-O blood type problem</h3>
<ul>
<li>Let the three alleles be A, B, and O.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">AA</th>
<th align="center">BB</th>
<th align="center">OO</th>
<th align="center">AO</th>
<th align="center">BO</th>
<th align="center">AB</th>
<th align="center">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Frequency</td>
<td align="center"><span class="math inline">\(p^2\)</span></td>
<td align="center"><span class="math inline">\(q^2\)</span></td>
<td align="center"><span class="math inline">\(r^2\)</span></td>
<td align="center">2pr</td>
<td align="center">2qr</td>
<td align="center">2pq</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">Count</td>
<td align="center"><span class="math inline">\(n_{AA}\)</span></td>
<td align="center"><span class="math inline">\(n_{BB}\)</span></td>
<td align="center"><span class="math inline">\(n_{OO}\)</span></td>
<td align="center"><span class="math inline">\(n_{AO}\)</span></td>
<td align="center"><span class="math inline">\(n_{BO}\)</span></td>
<td align="center"><span class="math inline">\(n_{AB}\)</span></td>
<td align="center">n</td>
</tr>
</tbody>
</table>
<ul>
<li>Observed <a href="data:$n_%7BA\cdot%7D=n_%7BAA%7D+n_%7BAO%7D=444(A-type),$" class="uri">data:$n_{A\cdot}=n_{AA}+n_{AO}=444(A-type),$</a> <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=132(B-type),n_{OO}=361(O-type),\)</span> <span class="math inline">\(n_{AB}=63(AB-type).\)</span></li>
<li>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</li>
<li>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ul>
</div>
<div id="solution-23" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>nA. &lt;-<span class="st"> </span><span class="dv">444</span>; nB. &lt;-<span class="st"> </span><span class="dv">132</span>; nOO &lt;-<span class="st"> </span><span class="dv">361</span>; nAB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span>r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb75-3"><a href="#cb75-3"></a>p[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span>; q[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span>; r[<span class="dv">1</span>] &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="st"> </span>p[<span class="dv">1</span>]<span class="op">-</span><span class="st"> </span>q[<span class="dv">1</span>])</span>
<span id="cb75-4"><a href="#cb75-4"></a>   <span class="co">#Given initial value of iteration</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) {</span>
<span id="cb75-6"><a href="#cb75-6"></a>  <span class="kw">return</span>((nB.<span class="op">*</span>b<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>b<span class="dv">-2</span><span class="op">*</span>a)<span class="op">+</span>nB.<span class="op">+</span>nAB)<span class="op">/</span>(nA.<span class="op">*</span>a<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>a<span class="dv">-2</span><span class="op">*</span>b)<span class="op">+</span>nA.<span class="op">+</span>nAB))</span>
<span id="cb75-7"><a href="#cb75-7"></a>}</span>
<span id="cb75-8"><a href="#cb75-8"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) {</span>
<span id="cb75-9"><a href="#cb75-9"></a> <span class="kw">return</span>(((<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>a<span class="dv">-2</span><span class="op">*</span>b))<span class="op">*</span>nA.<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>b<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>b<span class="dv">-2</span><span class="op">*</span>a))<span class="op">*</span>nB.<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO)<span class="op">/</span>((nB.<span class="op">*</span>b<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>b<span class="dv">-2</span><span class="op">*</span>a)<span class="op">+</span></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="st">                          </span>nB.<span class="op">+</span>nAB)))</span>
<span id="cb75-11"><a href="#cb75-11"></a>}</span>
<span id="cb75-12"><a href="#cb75-12"></a>threshold &lt;-<span class="st"> </span><span class="fl">1e-5</span></span>
<span id="cb75-13"><a href="#cb75-13"></a><span class="co">#Given the threshold</span></span>
<span id="cb75-14"><a href="#cb75-14"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">100</span>) {</span>
<span id="cb75-15"><a href="#cb75-15"></a>   p[k] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">f</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">g</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])))</span>
<span id="cb75-16"><a href="#cb75-16"></a>   q[k] &lt;-<span class="st"> </span><span class="kw">f</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">f</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">g</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])))</span>
<span id="cb75-17"><a href="#cb75-17"></a>   r[k] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>p[k] <span class="op">-</span><span class="st"> </span>q[k]</span>
<span id="cb75-18"><a href="#cb75-18"></a>   <span class="co">#Through the theoretical steps of the EM algorithm, the relationship between the iteration value at each step and the previous iteration value is obtained.</span></span>
<span id="cb75-19"><a href="#cb75-19"></a>   <span class="cf">if</span>((p[k]<span class="op">-</span>p[k<span class="dv">-1</span>] <span class="op">&lt;=</span><span class="st"> </span>threshold) <span class="op">&amp;</span><span class="st"> </span>(q[k]<span class="op">-</span>q[k<span class="dv">-1</span>] <span class="op">&lt;=</span><span class="st"> </span>threshold) <span class="op">&amp;</span></span>
<span id="cb75-20"><a href="#cb75-20"></a><span class="st">      </span>(r[k]<span class="op">-</span>r[k<span class="dv">-1</span>] <span class="op">&lt;=</span><span class="st"> </span>threshold))</span>
<span id="cb75-21"><a href="#cb75-21"></a>   <span class="co">#If the difference between two iterations of p, q, r is less than a given threshold, stop iteration</span></span>
<span id="cb75-22"><a href="#cb75-22"></a>       {<span class="kw">print</span>(<span class="kw">c</span>(k, p[k], q[k],r[k]))</span>
<span id="cb75-23"><a href="#cb75-23"></a>       <span class="cf">break</span></span>
<span id="cb75-24"><a href="#cb75-24"></a>    }</span>
<span id="cb75-25"><a href="#cb75-25"></a>}</span></code></pre></div>
<pre><code>## [1] 7.0000000 0.2976387 0.1027061 0.5996552</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,k,<span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw">plot</span>(x, p[<span class="dv">1</span><span class="op">:</span>k], <span class="st">&quot;b&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>), <span class="dt">main =</span> <span class="st">&quot;The log-maximum likelihood values in M-steps&quot;</span> , <span class="dt">xlab =</span> <span class="st">&quot;The number of iteration&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;The value of iteration&quot;</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="kw">lines</span>(x, q[<span class="dv">1</span><span class="op">:</span>k], <span class="st">&quot;b&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="kw">lines</span>(x, r[<span class="dv">1</span><span class="op">:</span>k], <span class="st">&quot;b&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;q&quot;</span>, <span class="st">&quot;r&quot;</span>),<span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Both pictures Show that the log-maximum likelihood values in M-steps are increasing. We can also find that the convergence rate of EM algorithm is very fast in this problem.</p>
</div>
<div id="exercises-3-page-204-advanced-r." class="section level3">
<h3>Exercises 3 (page 204, Advanced R).</h3>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="solution-24" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">data</span>(mtcars)</span>
<span id="cb78-2"><a href="#cb78-2"></a>formulas =<span class="st"> </span><span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="co"># for loop</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>result_<span class="dv">1</span> =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="cf">for</span> (i <span class="cf">in</span> formulas){</span>
<span id="cb78-6"><a href="#cb78-6"></a>  result_<span class="dv">1</span> =<span class="st"> </span><span class="kw">c</span>(result_<span class="dv">1</span>,<span class="kw">list</span>(<span class="kw">lm</span>(<span class="dt">data=</span>mtcars,i)))</span>
<span id="cb78-7"><a href="#cb78-7"></a>}</span>
<span id="cb78-8"><a href="#cb78-8"></a><span class="co">#lapply</span></span>
<span id="cb78-9"><a href="#cb78-9"></a>result_<span class="dv">2</span> =<span class="st"> </span><span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>mtcars)</span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="kw">print</span>(result_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">print</span>(result_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="excecises-3-and-6-page-213-214-advanced-r" class="section level3">
<h3>Excecises 3 and 6 (page 213-214, Advanced R)</h3>
<p>3.The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<p>6.Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="solution-25" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="dv">100</span>,</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb82-5"><a href="#cb82-5"></a>)</span>
<span id="cb82-6"><a href="#cb82-6"></a><span class="co"># Using anonymous function </span></span>
<span id="cb82-7"><a href="#cb82-7"></a>result_anonymous =<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(i) i<span class="op">$</span>p.value)</span>
<span id="cb82-8"><a href="#cb82-8"></a><span class="co"># Don&#39;t use anonymous fnction</span></span>
<span id="cb82-9"><a href="#cb82-9"></a>result_NO_anonymous =<span class="st"> </span><span class="kw">sapply</span>(trials,<span class="st">&#39;[[&#39;</span>,<span class="dt">i=</span><span class="dv">3</span>)</span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="kw">print</span>(result_anonymous)</span></code></pre></div>
<pre><code>##   [1] 0.31299515 0.02662199 0.57731909 0.77860212 0.03393766 0.14077632
##   [7] 0.59784481 0.81202201 0.05764048 0.79195009 0.64807999 0.75115198
##  [13] 0.48670436 0.77063950 0.36099663 0.55678348 0.67092615 0.64010611
##  [19] 0.23844874 0.06925583 0.61559463 0.15319997 0.66153439 0.18363302
##  [25] 0.27017477 0.72136380 0.45371726 0.57386823 0.56423834 0.39735162
##  [31] 0.93943957 0.57241145 0.24795559 0.87972603 0.95862343 0.88809279
##  [37] 0.89330366 0.71062202 0.30262444 0.76032264 0.60225693 0.04126443
##  [43] 0.15677722 0.97967816 0.21595006 0.20670349 0.04534688 0.12261914
##  [49] 0.47379265 0.10159243 0.89432502 0.06290727 0.42798333 0.21082211
##  [55] 0.15418956 0.82047302 0.09957458 0.87329923 0.63129033 0.81167351
##  [61] 0.06298501 0.62951189 0.90910889 0.70577293 0.31966527 0.13504754
##  [67] 0.42310981 0.49936067 0.50663183 0.27912321 0.36311465 0.68730683
##  [73] 0.73278768 0.21890989 0.04712118 0.94800710 0.46595159 0.53986669
##  [79] 0.84591250 0.86239409 0.39534905 0.63818903 0.03071930 0.15546733
##  [85] 0.60740568 0.22973029 0.32741078 0.32295042 0.79178782 0.13454595
##  [91] 0.43608306 0.45901685 0.91110279 0.14094954 0.31375577 0.57523723
##  [97] 0.13767691 0.79117357 0.58755383 0.61888611</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">print</span>(result_NO_anonymous)</span></code></pre></div>
<pre><code>##   [1] 0.31299515 0.02662199 0.57731909 0.77860212 0.03393766 0.14077632
##   [7] 0.59784481 0.81202201 0.05764048 0.79195009 0.64807999 0.75115198
##  [13] 0.48670436 0.77063950 0.36099663 0.55678348 0.67092615 0.64010611
##  [19] 0.23844874 0.06925583 0.61559463 0.15319997 0.66153439 0.18363302
##  [25] 0.27017477 0.72136380 0.45371726 0.57386823 0.56423834 0.39735162
##  [31] 0.93943957 0.57241145 0.24795559 0.87972603 0.95862343 0.88809279
##  [37] 0.89330366 0.71062202 0.30262444 0.76032264 0.60225693 0.04126443
##  [43] 0.15677722 0.97967816 0.21595006 0.20670349 0.04534688 0.12261914
##  [49] 0.47379265 0.10159243 0.89432502 0.06290727 0.42798333 0.21082211
##  [55] 0.15418956 0.82047302 0.09957458 0.87329923 0.63129033 0.81167351
##  [61] 0.06298501 0.62951189 0.90910889 0.70577293 0.31966527 0.13504754
##  [67] 0.42310981 0.49936067 0.50663183 0.27912321 0.36311465 0.68730683
##  [73] 0.73278768 0.21890989 0.04712118 0.94800710 0.46595159 0.53986669
##  [79] 0.84591250 0.86239409 0.39534905 0.63818903 0.03071930 0.15546733
##  [85] 0.60740568 0.22973029 0.32741078 0.32295042 0.79178782 0.13454595
##  [91] 0.43608306 0.45901685 0.91110279 0.14094954 0.31375577 0.57523723
##  [97] 0.13767691 0.79117357 0.58755383 0.61888611</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">library</span>(parallel)</span>
<span id="cb86-2"><a href="#cb86-2"></a>boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]</span>
<span id="cb86-3"><a href="#cb86-3"></a>rsquared &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.square</span>
<span id="cb86-4"><a href="#cb86-4"></a>boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="kw">rsquared</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> <span class="kw">boot_df</span>(mtcars)))</span>
<span id="cb86-6"><a href="#cb86-6"></a>}</span>
<span id="cb86-7"><a href="#cb86-7"></a></span>
<span id="cb86-8"><a href="#cb86-8"></a><span class="kw">system.time</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>, boot_lm))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 1.24 0.00 1.30</code></pre>
</div>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ul>
<li>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</li>
<li>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</li>
<li>Compare the computation time of the two functions with the function “microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p><strong>Code:</strong></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">set.seed</span>(<span class="dv">1201</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>rw_MeR &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb88-3"><a href="#cb88-3"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb88-4"><a href="#cb88-4"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb88-5"><a href="#cb88-5"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb88-6"><a href="#cb88-6"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb88-7"><a href="#cb88-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb88-8"><a href="#cb88-8"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb88-9"><a href="#cb88-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(<span class="kw">abs</span>(y) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</span>
<span id="cb88-10"><a href="#cb88-10"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb88-11"><a href="#cb88-11"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb88-12"><a href="#cb88-12"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb88-13"><a href="#cb88-13"></a>      }</span>
<span id="cb88-14"><a href="#cb88-14"></a>  }</span>
<span id="cb88-15"><a href="#cb88-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb88-16"><a href="#cb88-16"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="co">#using namespace Rcpp;</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="co">#// [[Rcpp::export]]</span></span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rw_MeC(double sigma, double x0, int N) {</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="st">  NumericVector x(N);</span></span>
<span id="cb89-7"><a href="#cb89-7"></a><span class="st">  x[0] = x0;</span></span>
<span id="cb89-8"><a href="#cb89-8"></a><span class="st">  double u, y;</span></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="st">  int k = 0;</span></span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="st">  for (int i = 1; i &lt; N; i++) </span></span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="st">  {</span></span>
<span id="cb89-12"><a href="#cb89-12"></a><span class="st">    y = rnorm(1, x[i-1], sigma)[0];</span></span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="st">    u = runif(1)[0];</span></span>
<span id="cb89-14"><a href="#cb89-14"></a><span class="st">    if (u &lt;= exp(-(abs(y) - abs(x[i-1])))) </span></span>
<span id="cb89-15"><a href="#cb89-15"></a><span class="st">    {</span></span>
<span id="cb89-16"><a href="#cb89-16"></a><span class="st">      x[i] = y; </span></span>
<span id="cb89-17"><a href="#cb89-17"></a><span class="st">    }</span></span>
<span id="cb89-18"><a href="#cb89-18"></a><span class="st">    else </span></span>
<span id="cb89-19"><a href="#cb89-19"></a><span class="st">    {</span></span>
<span id="cb89-20"><a href="#cb89-20"></a><span class="st">      x[i] = x[i-1];</span></span>
<span id="cb89-21"><a href="#cb89-21"></a><span class="st">      k++;</span></span>
<span id="cb89-22"><a href="#cb89-22"></a><span class="st">    }</span></span>
<span id="cb89-23"><a href="#cb89-23"></a><span class="st">  }</span></span>
<span id="cb89-24"><a href="#cb89-24"></a><span class="st">  return x;</span></span>
<span id="cb89-25"><a href="#cb89-25"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb90-2"><a href="#cb90-2"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb90-4"><a href="#cb90-4"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb90-5"><a href="#cb90-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)) {</span>
<span id="cb90-6"><a href="#cb90-6"></a>ts =<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR =</span> <span class="kw">rw_MeR</span>(sigma[i], x0, N)<span class="op">$</span>x, </span>
<span id="cb90-7"><a href="#cb90-7"></a>                    <span class="dt">rwC =</span> <span class="kw">rw_MeC</span>(sigma[i], x0, N))</span>
<span id="cb90-8"><a href="#cb90-8"></a><span class="kw">print</span>(<span class="kw">summary</span>(ts)[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span>
<span id="cb90-9"><a href="#cb90-9"></a></span>
<span id="cb90-10"><a href="#cb90-10"></a>rwR =<span class="st"> </span><span class="kw">rw_MeR</span>(sigma[i], x0, N)<span class="op">$</span>x</span>
<span id="cb90-11"><a href="#cb90-11"></a>rwC =<span class="st"> </span><span class="kw">rw_MeC</span>(sigma[i], x0, N)</span>
<span id="cb90-12"><a href="#cb90-12"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb90-13"><a href="#cb90-13"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb90-14"><a href="#cb90-14"></a>y &lt;-<span class="st"> </span>(rwR)[b<span class="op">:</span>N]</span>
<span id="cb90-15"><a href="#cb90-15"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">500</span>)</span>
<span id="cb90-16"><a href="#cb90-16"></a>QR &lt;-<span class="st"> </span><span class="kw">ifelse</span>(a <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>a), <span class="op">-</span><span class="kw">log</span>(<span class="dv">2-2</span><span class="op">*</span>a))</span>
<span id="cb90-17"><a href="#cb90-17"></a>Q1 &lt;-<span class="st"> </span><span class="kw">quantile</span>(rwR, a)</span>
<span id="cb90-18"><a href="#cb90-18"></a><span class="kw">qqplot</span>(QR, Q1, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;R  sigma=&quot;</span>,sigma[i]))</span>
<span id="cb90-19"><a href="#cb90-19"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>)</span>
<span id="cb90-20"><a href="#cb90-20"></a></span>
<span id="cb90-21"><a href="#cb90-21"></a>y &lt;-<span class="st"> </span>(rwC)[b<span class="op">:</span>N]</span>
<span id="cb90-22"><a href="#cb90-22"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">500</span>)</span>
<span id="cb90-23"><a href="#cb90-23"></a>QR &lt;-<span class="st"> </span><span class="kw">ifelse</span>(a <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>a), <span class="op">-</span><span class="kw">log</span>(<span class="dv">2-2</span><span class="op">*</span>a))</span>
<span id="cb90-24"><a href="#cb90-24"></a>Q2 &lt;-<span class="st"> </span><span class="kw">quantile</span>(rwC, a)</span>
<span id="cb90-25"><a href="#cb90-25"></a><span class="kw">qqplot</span>(QR, Q2, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;C  sigma=&quot;</span>,sigma[i]),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb90-26"><a href="#cb90-26"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>)</span>
<span id="cb90-27"><a href="#cb90-27"></a></span>
<span id="cb90-28"><a href="#cb90-28"></a><span class="kw">qqplot</span>(Q1, Q2, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;C-R  sigma=&quot;</span>,sigma[i]),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb90-29"><a href="#cb90-29"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>)</span>
<span id="cb90-30"><a href="#cb90-30"></a>}</span></code></pre></div>
<p>We found that when the variance sigma is large enough, the qq-plot of random Numbers obtained by Rcpp and R is relatively close to and proportional to, except the two ends.</p>
<p>However, the calculation time of Rcpp is significantly less than R, which also indicates that Rcpp can effectively improve our calculation efficiency.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
